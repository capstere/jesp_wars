<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <!-- Mobilanpassning -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Return of the JESP</title>
  <style>
    /******************************************************
     * BASINSTÄLLNINGAR & BAKGRUND
     ******************************************************/
    body {
      margin: 0;
      overflow: hidden;
      background: black;
      color: #ffe81f;
      font-family: 'Courier New', Courier, monospace;
    }
    .stars {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: black url('static/images/stars.jpeg') repeat;
      background-size: cover;
      z-index: -99;
    }

    /******************************************************
     * NEDRÄKNING (överst)
     ******************************************************/
    #countdown {
      position: fixed;
      top: 10px;
      width: 100%;
      text-align: center;
      font-size: 1.8em;
      z-index: 900;
      color: yellow;
    }

    /******************************************************
     * STARTKNAPP
     ******************************************************/
    #start-button {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 1.8em;
      padding: 20px 40px;
      background-color: #ffe81f;
      color: black;
      font-weight: bold;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: transform 0.2s;
      z-index: 1000;
    }
    #start-button:hover {
      transform: translate(-50%, -50%) scale(1.1);
      background: white;
    }

    /******************************************************
     * INTRO-TEXT (BLÅ)
     * Visas i ca 4 s och fades ut under 0 s (senare döljs via JS)
     ******************************************************/
    #intro-text {
      display: none;
      position: absolute;
      top: 40%;
      width: 100%;
      text-align: center;
      font-size: 2em;
      color: #4ee;
      z-index: 800;
      -webkit-animation: fadeOut 2s ease-out forwards;
              animation: fadeOut 2s ease-out forwards;
      -webkit-animation-delay: 2s;
              animation-delay: 2s;
    }
    @-webkit-keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }
    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }

    /******************************************************
     * LOGOTYP (FULLSKÄRM + CINEMATISK ZOOM-UT)
     * Logotypen ska täcka skärmen (16:9 PNG) och sedan zooma ut genom att krympa och flytta uppåt.
     * Observera: Bakgrundsmusiken startar när logotypen visas.
     ******************************************************/
    #logo {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      text-align: center;
      z-index: 850;
    }
    #logo img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      -webkit-animation: logoZoomOut 4s ease-out forwards;
              animation: logoZoomOut 4s ease-out forwards;
    }
    @-webkit-keyframes logoZoomOut {
      0% { -webkit-transform: scale(1) translateY(0); transform: scale(1) translateY(0); opacity: 1; }
      100% { -webkit-transform: scale(0.1) translateY(-100vh); transform: scale(0.1) translateY(-100vh); opacity: 0; }
    }
    @keyframes logoZoomOut {
      0% { transform: scale(1) translateY(0); opacity: 1; }
      100% { transform: scale(0.1) translateY(-100vh); opacity: 0; }
    }

    /******************************************************
     * CENTRALT TITLE-ELEMENT ("The Return of the JESP")
     ******************************************************/
    #main-title {
      display: none;
      position: fixed;
      top: 40%;
      left: 0;
      width: 100%;
      text-align: center;
      font-size: 3.5em;
      color: #ffe81f;
      opacity: 0;
      z-index: 860;
      -webkit-animation: fadeInTitle 2s ease-out forwards;
              animation: fadeInTitle 2s ease-out forwards;
    }
    @-webkit-keyframes fadeInTitle {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes fadeInTitle {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /******************************************************
     * CRAWL (STAR WARS‑STIL)
     * Crawl‑texten ska börja utanför botten, täcka skärmen och vara stor.
     * Rubrikerna ("EPISODE XX" och "RETURN OF THE JESP") ska vara centrerade.
     * I slutet tonas texten ut gradvis (så att de översta raderna blir suddiga).
     ******************************************************/
    .star-wars {
      display: none;
      position: relative;
      height: 100vh;
      overflow: hidden;
      perspective: 800px;
      z-index: 700;
    }
    .crawl {
      position: absolute;
      bottom: -120%;
      width: 100%;
      transform-origin: 50% 100%;
      -webkit-transform: rotateX(25deg);
              transform: rotateX(25deg);
      text-align: center;
      font-size: 2.5em;
      line-height: 1.8em;
      color: #ffe81f;
      padding: 0 5%;
      text-shadow: 2px 2px 8px #ffe81f, 0 0 10px #ffe81f;
      -webkit-animation: crawl 20s linear forwards;
              animation: crawl 20s linear forwards;
    }
    @-webkit-keyframes crawl {
      from { bottom: -120%; opacity: 1; }
      to { bottom: 100%; opacity: 0.3; }
    }
    @keyframes crawl {
      from { bottom: -120%; opacity: 1; }
      to { bottom: 100%; opacity: 0.3; }
    }

    /******************************************************
     * PLANET-EFFEKT
     * Planetbilden ska glida in med en "kamera sänker sig"‑effekt.
     * Bilden kommer in från botten (utan drop-shadow) och placeras högre.
     ******************************************************/
    #planet-effect {
      display: none;
      position: fixed;
      bottom: 0%;  /* Placera planeten vid botten */
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      opacity: 0;
      z-index: -2;
      -webkit-animation: planetSlideIn 3s ease-out forwards;
              animation: planetSlideIn 3s ease-out forwards;
      animation-delay: 24s;
    }
    @-webkit-keyframes planetSlideIn {
      from { -webkit-transform: translate(-50%, 50%); transform: translate(-50%, 50%); opacity: 0; }
      to { -webkit-transform: translate(-50%, 0); transform: translate(-50%, 0); opacity: 1; }
    }
    @keyframes planetSlideIn {
      from { transform: translate(-50%, 50%); opacity: 0; }
      to { transform: translate(-50%, 0); opacity: 1; }
    }

    /******************************************************
     * LJUDKNAPPAR (FRÅGOR)
     ******************************************************/
    #buttons {
      display: none;
      position: fixed;
      bottom: 30px;
      width: 100%;
      text-align: center;
      opacity: 0;
      z-index: 800;
      -webkit-animation: fadeInButtons 2s ease-in forwards;
              animation: fadeInButtons 2s ease-in forwards;
      animation-delay: 27s;
    }
    @-webkit-keyframes fadeInButtons {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes fadeInButtons {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .btn {
      background: #ffe81f;
      border: none;
      font-weight: bold;
      font-size: 1em;
      padding: 15px 20px;
      margin: 10px;
      cursor: pointer;
      transition: transform 0.3s ease-in-out, background 0.3s;
      border-radius: 8px;
    }
    .btn:hover {
      transform: scale(1.1);
      background: white;
    }

    /******************************************************
     * AUDIO
     ******************************************************/
    audio { display: none; }
  </style>
</head>
<body>
  <!-- Bakgrund: Stjärnhimmel -->
  <div class="stars"></div>

  <!-- Nedräkning (överst) -->
  <div id="countdown"></div>

  <!-- Startknapp -->
  <button id="start-button" onclick="startIntro()">May the JESP be with you</button>

  <!-- Intro-text (blå) -->
  <div id="intro-text">A long time ago, in a cepheid 'radbrytning' far, far away…</div>

  <!-- Logotyp (fullskärm) -->
  <div id="logo">
    <img src="static/images/starwars_logo.png" alt="Star Wars Logo">
  </div>

  <!-- Centralt Title-element -->
  <div id="main-title">The Return of the JESP</div>

  <!-- Crawl-sektionen -->
  <div class="star-wars" id="crawl-container">
    <div class="crawl" id="crawl-text">
      <p style="margin: 0;"><strong>EPISODE XX</strong></p>
      <p style="margin: 0;"><strong>RETURN OF THE JESP</strong></p>
      <p>
        The Jedi Knight known only as JESP has been summoned back from self-imposed exile by the FIRST ORDER.
      </p>
      <p>
        After vanishing without a trace, JESP was secretly captured by the sinister GURULAB.
      </p>
      <p>
        The once-promising Jedi has now escaped and crash-landed on his home planet of BROWSKIS.
      </p>
      <p>
        Alongside fierce allies, young JESP must board the Milliliter Falcon Tube—a vessel fully equipped for the mission ahead. Unfortunately, JESP is not.
      </p>
      <p>
        He cannot read a star map. He thinks "agile" is a species. He brought a spoon to a lightsaber duel.
      </p>
      <p>
        His Jedi training, as it was, must be suppressed. His journey has been static, but the corner of LABITULATE shelters him.
      </p>
      <p>
        Meanwhile, Senator TATU has dispatched remote probes into the far reaches of space—not to rescue him, but to uncover his ignorance.
      </p>
      <p>
        Unaware of the trials to come, JESP must now UNLEARN all that he once tried to learn.
      </p>
      <p>
        The fate of the galaxy may hang in the balance… but mostly, it's just hoping he stays out of the way.
      </p>
    </div>
  </div>

  <!-- Planet-effekt (utan drop-shadow) -->
  <img id="planet-effect" src="static/images/planet.png" alt="Planet with Moons">

  <!-- Ljudknappar -->
  <div id="buttons">
    <button class="btn" onclick="playSound('fraga1.mp3')">How?</button>
    <button class="btn" onclick="playSound('fraga2.mp3')">When?</button>
    <button class="btn" onclick="playSound('fraga3.mp3')">Why?</button>
    <button class="btn" onclick="playSound('do_it.mp3')">What?</button>
  </div>

  <!-- Audio-element -->
  <audio id="bgMusic" src="static/sounds/starwars_theme.mp3" preload="auto"></audio>
  <audio id="soundPlayer" preload="auto"></audio>

  <script>
    // Async sleep-funktion
    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    // Nedräkning – räknar ner till 2025-04-30
    function startCountdown() {
      const targetDate = new Date("2025-04-30T00:00:00").getTime();
      const countdownEl = document.getElementById("countdown");
      function updateCountdown() {
        const now = new Date().getTime();
        const distance = targetDate - now;
        if (distance < 0) {
          countdownEl.innerHTML = "JESP TIME!";
          clearInterval(interval);
          return;
        }
        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);
        countdownEl.innerHTML = `${days}d ${hours}h ${minutes}m ${seconds}s`;
      }
      updateCountdown();
      const interval = setInterval(updateCountdown, 1000);
    }

    // Huvudsekvensen med async/await
    async function startIntro() {
      // 1. Dölj startknappen
      document.getElementById("start-button").style.display = "none";
      
      // 2. Starta nedräkningen
      startCountdown();
      
      // 3. Visa intro-text (blå) under ca 5 s
      const introText = document.getElementById("intro-text");
      introText.style.display = "block";
      await sleep(5000);
      introText.style.display = "none";
      
      // 4. Vid 5 s: Visa logotyp + starta bakgrundsmusik
      const logo = document.getElementById("logo");
      logo.style.display = "block";
      const bgMusic = document.getElementById("bgMusic");
      bgMusic.load();
      bgMusic.volume = 1.0;
      bgMusic.currentTime = 0;
      try {
        await bgMusic.play();
      } catch (e) {
        console.log("Musikfel vid första försöket:", e);
        setTimeout(() => bgMusic.play().catch(e2 => console.log("Andra försöket:", e2)), 100);
        setTimeout(() => bgMusic.play().catch(e3 => console.log("Tredje försöket:", e3)), 500);
      }
      // Vänta 4 s för logotypanimationen (5 s - 9 s)
      await sleep(4000);
      logo.style.display = "none";
      
      // 5. Visa crawl-sektionen (börjar från botten) vid ca 5 s
      const crawlContainer = document.getElementById("crawl-container");
      crawlContainer.style.display = "block";
      // Crawl-animationen varar enligt CSS (20 s, 5 s–25 s)
      await sleep(20000);
      crawlContainer.style.display = "none";
      
      // 6. Visa centrala titeln ("The Return of the JESP") vid ca 25 s
      const mainTitle = document.getElementById("main-title");
      mainTitle.style.display = "block";
      await sleep(2000);
      
      // 7. Visa planet-effekten vid ca 27 s
      const planet = document.getElementById("planet-effect");
      planet.style.display = "block";
      planet.style.animation = "planetSlideIn 3s ease-out forwards";
      await sleep(3000);
      
      // 8. Visa ljudknappar vid ca 30 s
      const buttons = document.getElementById("buttons");
      buttons.style.display = "block";
      buttons.style.animation = "fadeInButtons 2s ease-in forwards";
    }

    // Funktion för att spela upp ljud via knappar
    function playSound(file) {
      const sound = document.getElementById("soundPlayer");
      sound.pause();
      sound.currentTime = 0;
      sound.src = `static/sounds/${file}`;
      sound.load();
      sound.play().catch(e => console.log("Ljudfel:", e));
    }
  </script>
</body>
</html>